<h3>
    <i class="glyphicon glyphicon-file"></i>
    &nbsp;{{chapter['@id']}}
</h3>

<div class="row" class="back-matter">
    <tabset>
        <tab ng-repeat="(header, content) in chapter['back']" heading="{{header}}">
            <!-- glossary -->
            <div ng-if="content.hasOwnProperty('def-list')">
                <table class="table">
                    <tr class="no-border-top">
                        <th width="20%"><span class="pull-right">List Title</span></th>
                        <td>
                        <span ng-if="!!content.hasOwnProperty('title')">
                            <a href="#" editable-text="content['title']">
                                {{content['title'] || 'empty'}}
                            </a>
                        </span>
                        </td>
                    </tr>
                </table>


                <ul ui-sortable="sortableOptions" ng-model="content['def-list']['def-item']" class="panel-group">
                    <li ng-repeat="def in content['def-list']['def-item']" class="panel pane-default">
                        <div class="handle btn btn-default">
                            <i class="glyphicon glyphicon-resize-vertical"></i>
                        </div>
                        <h4 class="panel-title pull-right" ng-model="isOpen" ng-init="false" ng-click="isOpen = !isOpen">
                            <span class="pull-left">{{$index+1}} <a>{{def['term']['#text']}}</a></span>
                        <span class="pull-right" >
                            <i class="glyphicon icon" ng-class="{'glyphicon-chevron-up':isOpen,'glyphicon-chevron-down':!isOpen}"></i>
                        </span>
                        </h4>
                        <div ng-show="isOpen" class="panel-body">
                            <table class="table">
                                <tr class="no-border-top">
                                    <th width="10%">Term</th>
                                    <td>
                                        <a href="#" editable-text="def['term']['#text']">
                                            {{def['term']['#text'] || 'empty'}}
                                        </a>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Description</th>
                                    <td>
                                        <a href="#" editable-textangular="def['def']['p']">
                                            <span ng-bind-html="def['def']['p'] || 'empty'"></span>
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </li>
                </ul>



            </div>
            <!-- end of glossary -->
            <!-- bibliography -->
            <div ng-if="content.hasOwnProperty('ref')">
                <table class="table">
                    <tr class="no-border-top">
                        <th width="20%"><span class="pull-right">List Title</span></th>
                        <td>
                        <span ng-if="!!content.hasOwnProperty('title')">
                            <a href="#" editable-text="content['title']">
                                {{content['title'] || 'empty'}}
                            </a>
                        </span>
                        </td>
                    </tr>
                </table>
                <ul ui-sortable="sortableOptions" ng-model="content['ref']" class="panel-group">
                    <li ng-repeat="ref in content['ref']" class="panel pane-default">
                        <div class="handle btn btn-default">
                            <i class="glyphicon glyphicon-resize-vertical"></i>
                        </div>
                        <h4 class="panel-title pull-right" ng-model="isOpen" ng-init="false" ng-click="isOpen = !isOpen">
                            <span class="pull-left">{{$index+1}} <a>{{ref['mixed-citation']['source']}}</a></span>
                        <span class="pull-right" >
                            <i class="glyphicon icon" ng-class="{'glyphicon-chevron-up':isOpen,'glyphicon-chevron-down':!isOpen}"></i>
                        </span>
                        </h4>
                        <div ng-show="isOpen" class="panel-body">
                            <table class="table">
                                <tr class="no-border-top">
                                    <th>Preview</td>
                                    <td colspan="2"></td>
                                </tr>
                                <tr>
                                    <th>Type</th>
                                    <td>
                                        <a editable-select="ref['mixed-citation']['@publication-type']" e-ng-options="type for type in bibType">
                                            {{ref['mixed-citation']['@publication-type'] || 'empty'}}
                                        </a>
                                    </td>
                                </tr>
                                <tr ng-if="ref['@publication-type'] == 'book'">
                                    <th>Book Title</th>
                                    <td colspan="2">
                                        <a href="#" editable-text="ref['mixed-citation']['source']" onbeforesave="isEmpty($data)">
                                            {{ref['mixed-citation']['source'] || 'empty'}}
                                        </a>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Publisher</th>
                                    <td>
                                        <span><strong>Name:</strong></span>
                                        <a href="#" editable-text="ref['mixed-citation']['publisher-name']">
                                            {{ref['mixed-citation']['publisher-name'] || 'empty'}}
                                        </a>
                                    </td>
                                    <td>
                                        <span><strong>Location:</strong></span>
                                        <a href="#" editable-text="ref['publisher-loc']">
                                            {{ref['mixed-citation']['publisher-loc'] || 'empty'}}
                                        </a>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Year</th>
                                    <td colspan="2">
                                        <a href="#" editable-text="ref['mixed-citation']['year']">
                                            {{ref['mixed-citation']['year'] || 'empty'}}
                                        </a>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </li>
                </ul>

            </div>
            <!-- end of bibliography -->

        </tab>
    </tabset>

</div>

<div>
    Debug Area
    <pre><code>{{chapter['back']['ref-list'] | json}}</code></pre>
</div>